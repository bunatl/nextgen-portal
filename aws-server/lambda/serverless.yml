service: portalo2

# deplyes each function individually
package:
  individually: true

provider:
  name: aws
  runtime: nodejs14.x
  region: eu-west-1
  lambdaHashingVersion: 20201221
  apiGateway:
    shouldStartNameWithService: true
  iam:
    role:
      statements: # permissions for all of your functions can be set here
        - Effect: Allow
          Action: # Gives permission to DynamoDB tables in a specific region
            - dynamodb:DescribeTable
            - dynamodb:Query
            - dynamodb:Scan
            - dynamodb:GetItem
            - dynamodb:PutItem
            - dynamodb:UpdateItem
            - dynamodb:DeleteItem
          Resource: arn:aws:dynamodb:eu-central-1:336526891729:table/Employees

functions:
  login:
    handler: login.login
    name: my-login-function
    memorySize: 128
    description: Function that log user.
    events:
    - httpApi: 
        path: /login
        method: post
  register:
    handler: register.register
    name: post-function
    memorySize: 128
    description: Function that register user.
    events:
    - httpApi: 
        path: /register
        method: post

# resources:
#   Resources:
#     MyDynamoDBEmployeesTable:
#       Type: AWS::DynamoDB::Table
#       Properties: 
#         TableName: Employees
#         AttributeDefinitions: 
#           - AttributeName: username
#             AttributeType: S
#         KeySchema: 
#           - AttributeName: username
#             KeyType: HASH
#         TimeToLiveSpecification: 
#           AttributeName: ExpirationTime
#           Enabled: true
#         ProvisionedThroughput: 
#           ReadCapacityUnits: 1
#           WriteCapacityUnits: 1
#     MyIamPolicy:
#       Type: AWS::IAM::ManagedPolicy
#       Properties:
#         Description: Policy for using a table Employees in DynamoDB
#         # PolicyName: employeesDynamoDescribeScanPutGetUpdateDelete
#         PolicyDocument:
#           Version: '2012-10-17'
#           Statement:
#             - 
#               Effect: Allow
#               Action:
#                 - dynamodb:PutItem
#                 - dynamodb:DescribeTable
#                 - dynamodb:DeleteItem
#                 - dynamodb:GetItem
#                 - dynamodb:Query
#                 - dynamodb:UpdateItem
#                 - dynamodb:UpdateTable
#               Resource: arn:aws:dynamodb:eu-central-1:336526891729:table/Employees
